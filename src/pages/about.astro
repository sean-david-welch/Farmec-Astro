---
import styles from '../styles/About.module.css'
import utils from '../styles/Utils.module.css'

import { Image } from 'astro:assets';

import Layout from "../layouts/Layout.astro";
import type {Employee, Timeline} from "../types/about"

export const prerender = true

const employees: Employee[] = await fetch('http://localhost:4321/api/employees').then(employees => employees.json());
const timelines: Timeline[] = await fetch('http://localhost:4321/api/timelines').then(timelines => timelines.json());
---

<Layout title="About Us">
    <section id="about">

        <h1 class={utils.sectionHeading}>Our Team</h1>
        <p class={utils.subHeading}>
            Meet our staff and management team
        </p>

        <section id="employees">
            <div class={styles.employees}>
                {employees.map(employee => (
                    <div class={styles.employeeCard}>
                        <Image
                            src={employee.profile_image || '/default.jpg'}
                            alt={'/default.jpg'}
                            width={100}
                            height={100}
                        />
                        <div class={styles.employeeInfo}>
                            <h1 class={utils.mainHeading}>
                                {employee.name}
                            </h1>
                            <p class={utils.paragraph}>{employee.role}</p>
                        </div>
                        <div class={styles.employeeContact}>
                            <p class={utils.paragraph}>
                                Email: {employee.email}
                            </p>
                            <p class={utils.paragraph}>
                                Mobile: {employee.phone}
                            </p>
                        </div>
                    </div>
                ))}
            </div>
        </section>

        <section id="timeline">
            <div class={styles.timeline}>
                {timelines.map((event) => (
                    <div class={styles.timelineCard}>
                    <h1 class={utils.mainHeading}>{event.title}</h1>
                    <h1 class={utils.paragraph}>
                        {event.date}
                    </h1>
                    <p class={utils.paragraph}>{event.body}</p>
                    </div>
                ))}
            </div>
        </section>   

    </section>
</Layout>
---